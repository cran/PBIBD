apbibd5 <-
function(v,r,k,l,n,P){
A1<-r*(k-1)+l[5]
A2<-l[5]-l[1]
A3<-l[5]-l[2]
A4<-l[5]-l[3]
A5<-l[5]-l[4]
B1<-(l[2]-l[1])*P[[5]][1,2]+(l[3]-l[1])*P[[5]][1,3]+(l[4]-l[1])*P[[5]][1,4]+(l[5]-l[1])*P[[5]][1,5]
B2<-A1+A2*(P[[1]][1,1]-P[[5]][1,1])+A3*(P[[1]][1,2]-P[[5]][1,2])+A4*(P[[1]][1,3]-P[[5]][1,3])+A5*(P[[1]][1,4]-P[[5]][1,4])
B3<-A2*(P[[2]][1,1]-P[[5]][1,1])+A3*(P[[2]][1,2]-P[[5]][1,2])+A4*(P[[2]][1,3]-P[[5]][1,3])+A5*(P[[2]][1,4]-P[[5]][1,4])
B4<-A2*(P[[3]][1,1]-P[[5]][1,1])+A3*(P[[3]][1,2]-P[[5]][1,2])+A4*(P[[3]][1,3]-P[[5]][1,3])+A5*(P[[3]][1,4]-P[[5]][1,4])
B5<-A2*(P[[4]][1,1]-P[[5]][1,1])+A3*(P[[4]][1,2]-P[[5]][1,2])+A4*(P[[4]][1,3]-P[[5]][1,3])+A5*(P[[4]][1,4]-P[[5]][1,4])
C1<-(l[1]-l[2])*P[[5]][2,1]+(l[3]-l[2])*P[[5]][2,3]+(l[4]-l[2])*P[[5]][2,4]+(l[5]-l[2])*P[[5]][2,5]
C2<-A2*(P[[1]][2,1]-P[[5]][2,1])+A3*(P[[1]][2,2]-P[[5]][2,2])+A4*(P[[1]][2,3]-P[[5]][2,3])+A5*(P[[1]][2,4]-P[[5]][2,4])
C3<-A1+A2*(P[[2]][2,1]-P[[5]][2,1])+A3*(P[[2]][2,2]-P[[5]][2,2])+A4*(P[[2]][2,3]-P[[5]][2,3])+A5*(P[[2]][2,4]-P[[5]][2,4])
C4<-A2*(P[[3]][2,1]-P[[5]][2,1])+A3*(P[[3]][2,2]-P[[5]][2,2])+A4*(P[[3]][2,3]-P[[5]][2,3])+A5*(P[[3]][2,4]-P[[5]][2,4])
C5<-A2*(P[[4]][2,1]-P[[5]][2,1])+A3*(P[[4]][2,2]-P[[5]][2,2])+A4*(P[[4]][2,3]-P[[5]][2,3])+A5*(P[[4]][2,4]-P[[5]][2,4])
D1<-(l[1]-l[3])*P[[5]][3,1]+(l[2]-l[3])*P[[5]][3,2]+(l[4]-l[3])*P[[5]][3,4]+(l[5]-l[3])*P[[5]][3,5]
D2<-A2*(P[[1]][3,1]-P[[5]][3,1])+A3*(P[[1]][3,2]-P[[5]][3,2])+A4*(P[[1]][3,3]-P[[5]][3,3])+A5*(P[[1]][3,4]-P[[5]][3,4])
D3<-A2*(P[[2]][3,1]-P[[5]][3,1])+A3*(P[[2]][3,2]-P[[5]][3,2])+A4*(P[[2]][3,3]-P[[5]][3,3])+A5*(P[[2]][3,4]-P[[5]][3,4])
D4<-A1+A2*(P[[3]][3,1]-P[[5]][3,1])+A3*(P[[3]][3,2]-P[[5]][3,2])+A4*(P[[3]][3,3]-P[[5]][3,3])+A5*(P[[3]][3,4]-P[[5]][3,4])
D5<-A2*(P[[4]][3,1]-P[[5]][3,1])+A3*(P[[4]][3,2]-P[[5]][3,2])+A4*(P[[4]][3,3]-P[[5]][3,3])+A5*(P[[4]][3,4]-P[[5]][3,4])
E1<-(l[1]-l[4])*P[[5]][4,1]+(l[2]-l[4])*P[[5]][4,2]+(l[3]-l[4])*P[[5]][4,3]+(l[5]-l[4])*P[[5]][4,5]
E2<-A2*(P[[1]][4,1]-P[[5]][4,1])+A3*(P[[1]][4,2]-P[[5]][4,2])+A4*(P[[1]][4,3]-P[[5]][4,3])+A5*(P[[1]][4,4]-P[[5]][4,4])
E3<-A2*(P[[2]][4,1]-P[[5]][4,1])+A3*(P[[2]][4,2]-P[[5]][4,2])+A4*(P[[2]][4,3]-P[[5]][4,3])+A5*(P[[2]][4,4]-P[[5]][4,4])
E4<-A2*(P[[3]][4,1]-P[[5]][4,1])+A3*(P[[3]][4,2]-P[[5]][4,2])+A4*(P[[3]][4,3]-P[[5]][4,3])+A5*(P[[3]][4,4]-P[[5]][4,4])
E5<-A1+A2*(P[[4]][4,1]-P[[5]][4,1])+A3*(P[[4]][4,2]-P[[5]][4,2])+A4*(P[[4]][4,3]-P[[5]][4,3])+A5*(P[[4]][4,4]-P[[5]][4,4])
F<-matrix(c(B2,C2,D2,E2,B3,C3,D3,E3,B4,C4,D4,E4,B5,C5,D5,E5),4,4)
G<-matrix(c(A2,C2,D2,E2,A3,C3,D3,E3,A4,C4,D4,E4,A5,C5,D5,E5),4,4)
H<-matrix(c(A2,B2,D2,E2,A3,B3,D3,E3,A4,B4,D4,E4,A5,B5,D5,E5),4,4)
I<-matrix(c(A2,B2,C2,E2,A3,B3,C3,E3,A4,B4,C4,E4,A5,B5,C5,E5),4,4)
J<-matrix(c(A2,B2,C2,D2,A3,B3,C3,D3,A4,B4,C4,D4,A5,B5,C5,D5),4,4)
del<-A1*det(F)-B1*det(G)+C1*det(H)-D1*det(I)+E1*det(J)
Eff1<-del/(r*k*(det(F)+det(G)))
Eff2<-del/(r*k*(det(F)-det(H)))
Eff3<-del/(r*k*(det(F)+det(I)))
Eff4<-del/(r*k*(det(F)-det(J)))
Eff5<-del/(r*k*(det(F)))
Eff<-del*(v-1)/(r*k*((v-1)*det(F)+n[1]*det(G)-n[2]*det(H)+n[3]*det(I)-n[4]*det(J)))
lst<-list(Efficiency_E1=Eff1,Efficiency_E2=Eff2,Efficienct_E3=Eff3,Efficiency_E4=Eff4,Efficiency_E5=Eff5,Overall_Efficiency_Factor=Eff)
return(lst)
}
